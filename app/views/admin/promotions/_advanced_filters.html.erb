<div class="relative flex flex-col w-full md:w-auto">
  <button
    type="button"
    class="btn btn-secondary text-sm px-3 py-2 rounded bg-gray-200 text-gray-950 focus:outline-none cursor-pointer"
    aria-expanded="false"
    aria-controls="more-filters"
    data-promotions-index-target="moreFiltersToggle"
    data-action="click->promotions-index#toggleMoreFilters keydown->promotions-index#toggleMoreFiltersKeydown"
  >
    Advanced Filters
  </button>

  <div
    id="more-filters"
    role="dialog"
    aria-modal="true"
    aria-labelledby="more-filters-label"
    class="hidden md:absolute left-0 md:left-auto md:right-4 top-0 md:top-auto md:mt-2 bg-white rounded-none md:rounded shadow border border-gray-200 z-50 w-full h-full md:w-[min(90vw,420px)] md:min-w-[320px] md:max-w-[500px] md:h-auto md:max-h-[80vh] focus:outline-none relative"
    tabindex="-1"
    data-promotions-index-target="moreFilters"
  >
    <div class="flex justify-between items-center border-b border-gray-200 py-2 px-4">
      <h4 id="more-filters-label" class="font-bold text-base">Advanced Filters</h4>
      <button
        type="button"
        aria-label="Close Advanced Filters"
        class="text-gray-600 hover:text-gray-900 flex items-center justify-center w-8 h-8 rounded-full hover:bg-gray-100 transition-colors"
        data-action="click->promotions-index#closeMoreFilters"
        tabindex="0"
      >
        <span class="material-icons text-xl">close</span>
      </button>
    </div>

    <div class="overflow-y-auto pb-32 md:pb-0 max-h-120 px-4">
      <!-- Sort -->
      <div class="mb-6 mt-2">
        <div class="font-semibold text-base mb-3 pb-2 border-b border-gray-200">Sort</div>
        <div class="flex flex-col">
          <label for="sort_by" class="text-xs font-medium text-gray-700 mb-1">Sort By</label>
          <select id="sort_by" name="sort_by" class="select select-bordered px-3 py-2 rounded border border-gray-300 text-sm">
            <optgroup label="Promotion Details">
              <option value="title_asc" <%= 'selected' if params[:sort_by] == 'title_asc' %>>Title (A → Z)</option>
              <option value="title_desc" <%= 'selected' if params[:sort_by] == 'title_desc' %>>Title (Z → A)</option>
              <option value="code_asc" <%= 'selected' if params[:sort_by] == 'code_asc' %>>Code (A → Z)</option>
              <option value="code_desc" <%= 'selected' if params[:sort_by] == 'code_desc' %>>Code (Z → A)</option>
            </optgroup>
            <optgroup label="Date">
              <option value="starts_at_asc" <%= 'selected' if params[:sort_by] == 'starts_at_asc' %>>Start Date (Oldest → Newest)</option>
              <option value="starts_at_desc" <%= 'selected' if params[:sort_by] == 'starts_at_desc' %>>Start Date (Newest → Oldest)</option>
              <option value="ends_at_asc" <%= 'selected' if params[:sort_by] == 'ends_at_asc' %>>End Date (Oldest → Newest)</option>
              <option value="ends_at_desc" <%= 'selected' if params[:sort_by] == 'ends_at_desc' %>>End Date (Newest → Oldest)</option>
              <option value="created_at_asc" <%= 'selected' if params[:sort_by] == 'created_at_asc' %>>Created (Oldest → Newest)</option>
              <option value="created_at_desc" <%= 'selected' if params[:sort_by] == 'created_at_desc' %>>Created (Newest → Oldest)</option>
            </optgroup>
          </select>
        </div>
      </div>

      <!-- Promotion Identification -->
      <div class="mb-6">
        <div class="font-semibold text-base mb-3 pb-2 border-b border-gray-200">Promotion Identification</div>
        <div class="space-y-3">
          <div class="flex flex-col">
            <label for="title" class="text-xs font-medium text-gray-700 mb-1">Title</label>
            <input id="title" type="text" name="title" value="<%= params[:title] %>" placeholder="Enter title..." class="input input-bordered text-sm w-full px-3 py-2 rounded border border-gray-300 focus:ring-2 focus:ring-sky-500">
          </div>
          <div class="flex flex-col">
            <label for="code-more" class="text-xs font-medium text-gray-700 mb-1">Code</label>
            <input id="code-more" type="text" name="code" value="<%= params[:code] %>" placeholder="Enter code..." class="input input-bordered text-sm w-full px-3 py-2 rounded border border-gray-300 focus:ring-2 focus:ring-sky-500">
          </div>
        </div>
      </div>

      <!-- Date Filters -->
      <div class="mb-6">
        <div class="font-semibold text-base mb-3 pb-2 border-b border-gray-200">Date Filters</div>
        <div class="space-y-4">
          <div class="flex flex-col">
            <label class="text-xs font-medium text-gray-700 mb-1">Starts At Range</label>
            <div class="flex gap-2">
              <input type="date" name="starts_after" value="<%= params[:starts_after] %>" placeholder="From" class="input input-bordered text-sm px-3 py-2 rounded border border-gray-300 focus:ring-2 focus:ring-sky-500">
              <input type="date" name="starts_before" value="<%= params[:starts_before] %>" placeholder="To" class="input input-bordered text-sm px-3 py-2 rounded border border-gray-300 focus:ring-2 focus:ring-sky-500">
            </div>
          </div>
          <div class="flex flex-col">
            <label class="text-xs font-medium text-gray-700 mb-1">Ends At Range</label>
            <div class="flex gap-2">
              <input type="date" name="ends_after" value="<%= params[:ends_after] %>" placeholder="From" class="input input-bordered text-sm px-3 py-2 rounded border border-gray-300 focus:ring-2 focus:ring-sky-500">
              <input type="date" name="ends_before" value="<%= params[:ends_before] %>" placeholder="To" class="input input-bordered text-sm px-3 py-2 rounded border border-gray-300 focus:ring-2 focus:ring-sky-500">
            </div>
          </div>
        </div>
      </div>

      <!-- Promotion Status -->
      <div class="mb-4">
        <div class="font-semibold text-base mb-3 pb-2 border-b border-gray-200">Status</div>
        <div class="flex flex-col">
          <label for="active-more" class="text-xs font-medium text-gray-700 mb-1">Active</label>
          <select id="active-more" name="active" class="select select-bordered px-3 py-2 rounded border border-gray-300 text-sm">
            <option value="">All</option>
            <option value="true" <%= "selected" if params[:active] == "true" %>>Active</option>
            <option value="false" <%= "selected" if params[:active] == "false" %>>Inactive</option>
          </select>
        </div>
      </div>
    </div>

    <!-- Sticky Footer for Mobile Actions -->
    <div class="fixed md:static bottom-0 left-0 w-full bg-white border-t border-gray-200 flex justify-end gap-2 p-4 z-50 md:bg-transparent">
      <button
        type="button"
        data-action="promotions-index#clearAdvancedFilters"
        class="w-1/2 md:w-auto min-w-16 px-3 py-0.5 md:py-2 rounded text-base md:text-sm border border-gray-300 bg-white text-gray-700 hover:bg-gray-100 focus:ring-2 focus:ring-gray-500 focus:outline-none transition">
        Clear All
      </button>
      <button
        type="submit"
        class="w-1/2 md:w-auto min-w-16 px-3 py-0.5 md:py-2 rounded text-base md:text-sm bg-gray-950 text-white hover:bg-gray-700 focus:ring-2 focus:ring-gray-500 focus:outline-none transition">
        Apply
      </button>
    </div>
  </div>
</div>
